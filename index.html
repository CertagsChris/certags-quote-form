<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Certags Quote Request Form</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1a1a1a 0%, #000000 100%);
            color: #FFD700;
            padding: 30px;
            text-align: center;
            border-bottom: 4px solid #FFD700;
        }
        
        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }
        
        .header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .form-content {
            padding: 40px;
        }
        
        .form-section {
            margin-bottom: 35px;
        }
        
        .form-section h2 {
            font-size: 18px;
            color: #1a1a1a;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #FFD700;
        }
        
        .item-header {
            background: #FFD700;
            color: #1a1a1a;
            padding: 15px;
            margin: 30px -40px 20px -40px;
            font-size: 20px;
            font-weight: 700;
            text-align: center;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }
        
        label .required {
            color: #e74c3c;
        }
        
        input[type="text"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
            font-family: inherit;
        }
        
        input[type="text"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #FFD700;
        }
        
        textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            background: #f8f9fa;
        }
        
        .checkbox-option {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .checkbox-option input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .checkbox-option label {
            margin: 0;
            font-weight: 500;
            cursor: pointer;
            flex: 1;
        }
        
        .checkbox-other-input {
            margin-top: 5px;
            margin-left: 26px;
            display: none;
        }
        
        .file-upload {
            position: relative;
            display: inline-block;
            width: 100%;
        }
        
        .file-upload input[type="file"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }
        
        .file-upload-label {
            display: block;
            padding: 12px;
            background: #f8f9fa;
            border: 2px dashed #d0d0d0;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .file-upload-label:hover {
            background: #e9ecef;
            border-color: #FFD700;
        }
        
        .file-name {
            margin-top: 8px;
            font-size: 14px;
            color: #FFD700;
            font-weight: 700;
            background: #1a1a1a;
            padding: 8px 12px;
            border-radius: 4px;
            display: none;
            word-wrap: break-word;
        }
        
        .file-name.active {
            display: block;
        }
        
        .quantity-hint {
            font-size: 12px;
            color: #888;
            margin-top: 5px;
        }
        
        .submit-section {
            margin-top: 40px;
            text-align: center;
        }
        
        button[type="submit"] {
            background: linear-gradient(135deg, #FFD700 0%, #FFC700 100%);
            color: #1a1a1a;
            border: none;
            padding: 15px 60px;
            font-size: 16px;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button[type="submit"]:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.4);
        }
        
        button[type="submit"]:active {
            transform: translateY(0);
        }
        
        .item-container {
            display: none;
        }
        
        .item-container.active {
            display: block;
        }
        
        .product-specs {
            display: none;
        }
        
        .product-specs.active {
            display: block;
        }
        
        .add-item-section {
            background: #fffbea;
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #FFD700;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .form-content {
                padding: 25px;
            }
            
            .item-header {
                margin-left: -25px;
                margin-right: -25px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Certags LLC</h1>
            <p>Product Quote Request Form</p>
        </div>
        
        <div class="form-content">
            <form id="quoteForm" action="https://formsubmit.co/d0e976ab656743bb7a46ac7208fec145" method="POST" enctype="multipart/form-data">
                <input type="hidden" name="_subject" id="email_subject" value="New Quote Request from Certags Form">
                <input type="hidden" name="_replyto" id="reply_to_email">
                <input type="hidden" name="_cc" id="cc_email">
                <input type="hidden" name="_captcha" value="false">
                <input type="text" name="_honey" style="display:none">
                <input type="hidden" name="_template" value="box">
                <input type="hidden" name="QUOTE_SUMMARY" id="formatted_quote">
                <input type="hidden" name="sales_rep_email_visible" id="sales_rep_email_visible">
                
                <div class="form-section">
                    <h2>Request Information</h2>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Sales Rep <span class="required">*</span></label>
                            <select name="sales_rep" required>
                                <option value="">Select Sales Rep</option>
                                <option value="Roman">Roman</option>
                                <option value="Zack">Zack</option>
                                <option value="Andrew">Andrew</option>
                                <option value="Jake">Jake</option>
                                <option value="Jose">Jose</option>
                                <option value="Tanner">Tanner</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label>Customer Company Name <span class="required">*</span></label>
                            <input type="text" name="customer_company" required>
                        </div>
                    </div>
                </div>
                
                <div id="items_container">
                    <!-- Items 1-5 will be generated by JavaScript -->
                </div>
                
                <div class="submit-section">
                    <button type="submit">Submit Quote Request</button>
                </div>
            </form>
        </div>
    </div>
    
    <script>
        // Generate item forms dynamically
        function createItemHTML(itemNum) {
            const isFirst = itemNum === 1;
            return `
                <div class="item-container ${isFirst ? 'active' : ''}" id="item${itemNum}_container">
                    <div class="item-header">ITEM ${itemNum}</div>
                    
                    <div class="form-section">
                        <h2>Product Information</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Product Type <span class="required">*</span></label>
                                <select name="item${itemNum}_product_type" id="item${itemNum}_product_type" ${isFirst ? 'required' : ''}>
                                    <option value="">Select Product Type</option>
                                    <option value="Metal Tags">Metal Tags</option>
                                    <option value="Magnets">Magnets</option>
                                    <option value="Custom Labels">Custom Labels</option>
                                    <option value="Other">Other</option>
                                </select>
                                <textarea name="item${itemNum}_product_type_other" id="item${itemNum}_product_type_other" placeholder="Please describe the product" style="display:none; margin-top:10px; min-height: 80px;"></textarea>
                            </div>
                            <div class="form-group"></div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h2>Quantity & Size</h2>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Quantity <span class="required">*</span></label>
                                <input type="text" name="item${itemNum}_quantity" ${isFirst ? 'required' : ''} placeholder="e.g., 500 or 500 / 1000 / 2000">
                                <div class="quantity-hint">Enter single quantity or multiple tiers separated by slashes</div>
                            </div>
                            
                            <div class="form-group">
                                <label>Size <span class="required">*</span></label>
                                <input type="text" name="item${itemNum}_size" ${isFirst ? 'required' : ''} placeholder="e.g., 3 x 5 (inches assumed)">
                                <div class="quantity-hint">Enter dimensions - inches assumed unless otherwise specified</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Metal Tags Specs -->
                    <div id="item${itemNum}_metal_specs" class="product-specs">
                        <div class="form-section">
                            <h2>Metal Tag Specifications</h2>
                            
                            <div class="form-group">
                                <label>Material <span class="quantity-hint">(select all that apply)</span></label>
                                <div class="checkbox-group">
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_material" value="Aluminum" id="item${itemNum}_mat_aluminum">
                                        <label for="item${itemNum}_mat_aluminum">Aluminum</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_material" value="Stainless Steel" id="item${itemNum}_mat_stainless">
                                        <label for="item${itemNum}_mat_stainless">Stainless Steel</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_material" value="Other" id="item${itemNum}_mat_other">
                                        <label for="item${itemNum}_mat_other">Other</label>
                                    </div>
                                    <input type="text" name="item${itemNum}_material_other" id="item${itemNum}_material_other" placeholder="Please specify other material" class="checkbox-other-input">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label>Thickness <span class="quantity-hint">(select all that apply)</span></label>
                                <div class="checkbox-group">
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_thickness" value="0.5mm" id="item${itemNum}_thick_05">
                                        <label for="item${itemNum}_thick_05">0.5 mm</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_thickness" value="1mm" id="item${itemNum}_thick_1">
                                        <label for="item${itemNum}_thick_1">1 mm</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_thickness" value="Other" id="item${itemNum}_thick_other">
                                        <label for="item${itemNum}_thick_other">Other</label>
                                    </div>
                                    <input type="text" name="item${itemNum}_thickness_other" id="item${itemNum}_thickness_other" placeholder="Please specify other thickness" class="checkbox-other-input">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Print</label>
                                    <select name="item${itemNum}_print" id="item${itemNum}_print">
                                        <option value="">Select Print Option</option>
                                        <option value="One Side">One Side</option>
                                        <option value="Two Side">Two Side</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_print_other" id="item${itemNum}_print_other" placeholder="Please specify print option" style="display:none; margin-top:10px;">
                                </div>
                                <div class="form-group"></div>
                            </div>
                            
                            <div class="form-group">
                                <label>Print Method <span class="quantity-hint">(select all that apply)</span></label>
                                <div class="checkbox-group">
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_print_method" value="Digital" id="item${itemNum}_pm_digital">
                                        <label for="item${itemNum}_pm_digital">Digital</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_print_method" value="Etch and Fill" id="item${itemNum}_pm_etchfill">
                                        <label for="item${itemNum}_pm_etchfill">Etch and Fill</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_print_method" value="Etch, No Fill" id="item${itemNum}_pm_etchno">
                                        <label for="item${itemNum}_pm_etchno">Etch, No Fill</label>
                                    </div>
                                    <div class="checkbox-option">
                                        <input type="checkbox" name="item${itemNum}_print_method" value="Other" id="item${itemNum}_pm_other">
                                        <label for="item${itemNum}_pm_other">Other</label>
                                    </div>
                                    <input type="text" name="item${itemNum}_print_method_other" id="item${itemNum}_print_method_other" placeholder="Please specify other print method" class="checkbox-other-input">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Print Color</label>
                                    <select name="item${itemNum}_print_color" id="item${itemNum}_print_color">
                                        <option value="">Select Print Color</option>
                                        <option value="Black">Black</option>
                                        <option value="Multiple Colors">Multiple Colors</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_print_color_other" id="item${itemNum}_print_color_other" placeholder="Please specify print color" style="display:none; margin-top:10px;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Hole</label>
                                    <select name="item${itemNum}_hole" id="item${itemNum}_hole">
                                        <option value="">Select Hole Option</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                        <option value="Multiple">Multiple</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_hole_size" id="item${itemNum}_hole_size" placeholder="Enter hole size" style="display:none; margin-top:10px;">
                                    <input type="text" name="item${itemNum}_hole_size_number" id="item${itemNum}_hole_size_number" placeholder="Enter hole size and number" style="display:none; margin-top:10px;">
                                    <input type="text" name="item${itemNum}_hole_other" id="item${itemNum}_hole_other" placeholder="Please specify hole option" style="display:none; margin-top:10px;">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Adhesive</label>
                                    <select name="item${itemNum}_adhesive" id="item${itemNum}_adhesive">
                                        <option value="">Select Adhesive Option</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_adhesive_other" id="item${itemNum}_adhesive_other" placeholder="Please specify adhesive option" style="display:none; margin-top:10px;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Variable Data</label>
                                    <select name="item${itemNum}_variable_data_metal" id="item${itemNum}_variable_data_metal">
                                        <option value="">Select Option</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_variable_data_metal_other" id="item${itemNum}_variable_data_metal_other" placeholder="Please specify" style="display:none; margin-top:10px;">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Magnets Specs -->
                    <div id="item${itemNum}_magnet_specs" class="product-specs">
                        <div class="form-section">
                            <h2>Magnet Specifications</h2>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Laminated</label>
                                    <select name="item${itemNum}_laminated_magnet">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Print</label>
                                    <select name="item${itemNum}_print_magnet" id="item${itemNum}_print_magnet">
                                        <option value="">Select Print Option</option>
                                        <option value="Single Color">Single Color</option>
                                        <option value="Multi Color">Multi Color</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_print_magnet_other" id="item${itemNum}_print_magnet_other" placeholder="Please specify" style="display:none; margin-top:10px;">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Variable Data</label>
                                    <select name="item${itemNum}_variable_data_magnet">
                                        <option value="">Select Option</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                                <div class="form-group"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Labels Specs -->
                    <div id="item${itemNum}_label_specs" class="product-specs">
                        <div class="form-section">
                            <h2>Custom Label Specifications</h2>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Material</label>
                                    <select name="item${itemNum}_material_label" id="item${itemNum}_material_label">
                                        <option value="">Select Material</option>
                                        <option value="Poly">Poly</option>
                                        <option value="Vinyl">Vinyl</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_material_label_other" id="item${itemNum}_material_label_other" placeholder="Please specify material" style="display:none; margin-top:10px;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Laminated</label>
                                    <select name="item${itemNum}_laminated_label">
                                        <option value="Yes" selected>Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Print</label>
                                    <select name="item${itemNum}_print_label" id="item${itemNum}_print_label">
                                        <option value="">Select Print Option</option>
                                        <option value="Single Color">Single Color</option>
                                        <option value="Multi Color">Multi Color</option>
                                        <option value="Other">Other</option>
                                    </select>
                                    <input type="text" name="item${itemNum}_print_label_other" id="item${itemNum}_print_label_other" placeholder="Please specify" style="display:none; margin-top:10px;">
                                </div>
                                
                                <div class="form-group">
                                    <label>Variable Data</label>
                                    <select name="item${itemNum}_variable_data_label">
                                        <option value="">Select Option</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Other Product Specs -->
                    <div id="item${itemNum}_other_specs" class="product-specs">
                        <div class="form-section">
                            <h2>Product Specifications</h2>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Material</label>
                                    <input type="text" name="item${itemNum}_material_other_product" placeholder="Enter material">
                                </div>
                                
                                <div class="form-group">
                                    <label>Thickness</label>
                                    <input type="text" name="item${itemNum}_thickness_other_product" placeholder="Enter thickness">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>One Side or Two Side</label>
                                    <input type="text" name="item${itemNum}_sides_other_product" placeholder="Enter one side or two side">
                                </div>
                                
                                <div class="form-group">
                                    <label>Print Color(s)</label>
                                    <input type="text" name="item${itemNum}_print_colors_other_product" placeholder="Enter print colors">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Print Method</label>
                                    <input type="text" name="item${itemNum}_print_method_other_product" placeholder="Enter print method">
                                </div>
                                
                                <div class="form-group">
                                    <label>Laminate</label>
                                    <input type="text" name="item${itemNum}_laminate_other_product" placeholder="Enter laminate info">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Adhesive</label>
                                    <input type="text" name="item${itemNum}_adhesive_other_product" placeholder="Enter adhesive info">
                                </div>
                                
                                <div class="form-group">
                                    <label>Hole</label>
                                    <input type="text" name="item${itemNum}_hole_other_product" placeholder="Enter hole info">
                                </div>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Variable Data</label>
                                    <input type="text" name="item${itemNum}_variable_data_other_product" placeholder="Enter variable data info">
                                </div>
                                
                                <div class="form-group">
                                    <label>Other</label>
                                    <input type="text" name="item${itemNum}_other_field_other_product" placeholder="Enter other specifications">
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h2>Design</h2>
                        <div class="form-group">
                            <label>Upload Design File(s)</label>
                            <div class="file-upload">
                                <input type="file" id="designFile${itemNum}" name="design_file_${itemNum}" accept=".pdf,.ai,.eps,.jpg,.jpeg,.png,.svg" multiple>
                                <label for="designFile${itemNum}" class="file-upload-label">
                                    ðŸ“Ž Click to upload design files (PDF, AI, EPS, JPG, PNG, SVG) - Multiple files allowed
                                </label>
                            </div>
                            <div class="file-name" id="fileName${itemNum}"></div>
                        </div>
                    </div>
                    
                    <div class="form-section">
                        <h2>Additional Information</h2>
                        <div class="form-group">
                            <label>Other Comments / Special Requests</label>
                            <textarea name="item${itemNum}_other_info" placeholder="Enter any additional information or special requests here..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label>Previously Quoted / Ordered? <span class="required">*</span></label>
                            <select name="item${itemNum}_previously_quoted" id="item${itemNum}_previously_quoted" ${isFirst ? 'required' : ''} class="item-required-field">
                                <option value="">Select Option</option>
                                <option value="No">No</option>
                                <option value="Yes">Yes</option>
                            </select>
                            <input type="text" name="item${itemNum}_previously_quoted_details" id="item${itemNum}_previously_quoted_details" placeholder="Please provide IN#, Quote Date, or similar details" style="display:none; margin-top:10px;">
                        </div>
                    </div>
                    
                    ${itemNum < 5 ? `
                    <div class="add-item-section" id="add_item${itemNum + 1}_section" style="display:none;">
                        <div class="form-group" style="margin-bottom: 0;">
                            <label style="display: flex; align-items: center; cursor: pointer;">
                                <input type="checkbox" id="addItem${itemNum + 1}" style="width: auto; margin-right: 10px; cursor: pointer;">
                                <span style="font-size: 16px;">Add Item ${itemNum + 1} for this same customer</span>
                            </label>
                            <div class="quantity-hint" style="margin-left: 30px;">Check this to add another product to this quote request.</div>
                        </div>
                    </div>
                    ` : ''}
                </div>
            `;
        }
        
        // Generate all 5 items on page load
        const itemsContainer = document.getElementById('items_container');
        for (let i = 1; i <= 5; i++) {
            itemsContainer.innerHTML += createItemHTML(i);
        }
        
        // Show "Add Item 2" section after Item 1 is filled
        setTimeout(() => {
            document.getElementById('add_item2_section').style.display = 'block';
        }, 100);
        
        // Setup event listeners for all items
        function setupItemListeners(itemNum) {
            // File upload
            const fileInput = document.getElementById(`designFile${itemNum}`);
            if (fileInput) {
                fileInput.addEventListener('change', function(e) {
                    const files = e.target.files;
                    const fileNameDisplay = document.getElementById(`fileName${itemNum}`);
                    if (files.length > 0) {
                        const fileNames = Array.from(files).map(f => f.name).join(', ');
                        fileNameDisplay.textContent = `âœ… ${files.length} file(s) uploaded: ${fileNames}`;
                        fileNameDisplay.classList.add('active');
                    } else {
                        fileNameDisplay.textContent = '';
                        fileNameDisplay.classList.remove('active');
                    }
                });
            }
            
            // Product type change
            const productType = document.getElementById(`item${itemNum}_product_type`);
            if (productType) {
                productType.addEventListener('change', function() {
                    const metalSpecs = document.getElementById(`item${itemNum}_metal_specs`);
                    const magnetSpecs = document.getElementById(`item${itemNum}_magnet_specs`);
                    const labelSpecs = document.getElementById(`item${itemNum}_label_specs`);
                    const otherSpecs = document.getElementById(`item${itemNum}_other_specs`);
                    const otherTextarea = document.getElementById(`item${itemNum}_product_type_other`);
                    
                    metalSpecs.classList.remove('active');
                    magnetSpecs.classList.remove('active');
                    labelSpecs.classList.remove('active');
                    otherSpecs.classList.remove('active');
                    otherTextarea.style.display = 'none';
                    
                    if (this.value === 'Metal Tags') {
                        metalSpecs.classList.add('active');
                    } else if (this.value === 'Magnets') {
                        magnetSpecs.classList.add('active');
                    } else if (this.value === 'Custom Labels') {
                        labelSpecs.classList.add('active');
                    } else if (this.value === 'Other') {
                        otherSpecs.classList.add('active');
                        otherTextarea.style.display = 'block';
                    }
                });
            }
            
            // "Other" checkboxes for metal tags
            const matOther = document.getElementById(`item${itemNum}_mat_other`);
            const thickOther = document.getElementById(`item${itemNum}_thick_other`);
            const pmOther = document.getElementById(`item${itemNum}_pm_other`);
            
            if (matOther) {
                matOther.addEventListener('change', function() {
                    document.getElementById(`item${itemNum}_material_other`).style.display = this.checked ? 'block' : 'none';
                });
            }
            if (thickOther) {
                thickOther.addEventListener('change', function() {
                    document.getElementById(`item${itemNum}_thickness_other`).style.display = this.checked ? 'block' : 'none';
                });
            }
            if (pmOther) {
                pmOther.addEventListener('change', function() {
                    document.getElementById(`item${itemNum}_print_method_other`).style.display = this.checked ? 'block' : 'none';
                });
            }
            
            // "Other" dropdowns
            const dropdowns = [
                `item${itemNum}_print`, `item${itemNum}_print_color`, `item${itemNum}_adhesive`, 
                `item${itemNum}_variable_data_metal`, `item${itemNum}_print_magnet`, 
                `item${itemNum}_material_label`, `item${itemNum}_print_label`
            ];
            
            dropdowns.forEach(fieldName => {
                const dropdown = document.getElementById(fieldName);
                const otherInput = document.getElementById(fieldName + '_other');
                if (dropdown && otherInput) {
                    dropdown.addEventListener('change', function() {
                        otherInput.style.display = this.value === 'Other' ? 'block' : 'none';
                    });
                }
            });
            
            // Special handling for Hole field
            const holeDropdown = document.getElementById(`item${itemNum}_hole`);
            if (holeDropdown) {
                const holeSizeInput = document.getElementById(`item${itemNum}_hole_size`);
                const holeSizeNumberInput = document.getElementById(`item${itemNum}_hole_size_number`);
                const holeOtherInput = document.getElementById(`item${itemNum}_hole_other`);
                
                holeDropdown.addEventListener('change', function() {
                    // Hide all inputs first
                    if (holeSizeInput) holeSizeInput.style.display = 'none';
                    if (holeSizeNumberInput) holeSizeNumberInput.style.display = 'none';
                    if (holeOtherInput) holeOtherInput.style.display = 'none';
                    
                    // Show appropriate input based on selection
                    if (this.value === 'Yes' && holeSizeInput) {
                        holeSizeInput.style.display = 'block';
                    } else if (this.value === 'Multiple' && holeSizeNumberInput) {
                        holeSizeNumberInput.style.display = 'block';
                    } else if (this.value === 'Other' && holeOtherInput) {
                        holeOtherInput.style.display = 'block';
                    }
                });
            }
            
            // Handle "Previously Quoted" field
            const prevQuoted = document.getElementById(`item${itemNum}_previously_quoted`);
            const prevQuotedDetails = document.getElementById(`item${itemNum}_previously_quoted_details`);
            if (prevQuoted && prevQuotedDetails) {
                prevQuoted.addEventListener('change', function() {
                    if (this.value === 'Yes') {
                        prevQuotedDetails.style.display = 'block';
                        prevQuotedDetails.required = true;
                    } else {
                        prevQuotedDetails.style.display = 'none';
                        prevQuotedDetails.required = false;
                        prevQuotedDetails.value = '';
                    }
                });
            }
            
            // Add next item checkbox
            if (itemNum < 5) {
                const addNextItem = document.getElementById(`addItem${itemNum + 1}`);
                if (addNextItem) {
                    addNextItem.addEventListener('change', function() {
                        const nextContainer = document.getElementById(`item${itemNum + 1}_container`);
                        const nextAddSection = document.getElementById(`add_item${itemNum + 2}_section`);
                        
                        if (this.checked) {
                            nextContainer.classList.add('active');
                            if (nextAddSection && itemNum + 1 < 5) {
                                nextAddSection.style.display = 'block';
                            }
                            
                            // Make next item fields required
                            const nextProductType = document.getElementById(`item${itemNum + 1}_product_type`);
                            const nextQuantity = document.getElementById(`item${itemNum + 1}_quantity`);
                            const nextSize = document.getElementById(`item${itemNum + 1}_size`);
                            const nextPrevQuoted = document.getElementById(`item${itemNum + 1}_previously_quoted`);
                            if (nextProductType) nextProductType.required = true;
                            if (nextQuantity) nextQuantity.required = true;
                            if (nextSize) nextSize.required = true;
                            if (nextPrevQuoted) nextPrevQuoted.required = true;
                            
                            setTimeout(() => {
                                nextContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
                            }, 100);
                        } else {
                            nextContainer.classList.remove('active');
                            if (nextAddSection) {
                                nextAddSection.style.display = 'none';
                            }
                            
                            // Remove required from next item fields
                            const nextProductType = document.getElementById(`item${itemNum + 1}_product_type`);
                            const nextQuantity = document.getElementById(`item${itemNum + 1}_quantity`);
                            const nextSize = document.getElementById(`item${itemNum + 1}_size`);
                            const nextPrevQuoted = document.getElementById(`item${itemNum + 1}_previously_quoted`);
                            if (nextProductType) nextProductType.required = false;
                            if (nextQuantity) nextQuantity.required = false;
                            if (nextSize) nextSize.required = false;
                            if (nextPrevQuoted) nextPrevQuoted.required = false;
                            
                            // Clear all form data for next item and subsequent items
                            for (let j = itemNum + 1; j <= 5; j++) {
                                const itemContainer = document.getElementById(`item${j}_container`);
                                if (itemContainer) {
                                    // Clear all inputs, selects, and textareas in this container
                                    const inputs = itemContainer.querySelectorAll('input[type="text"], input[type="file"], textarea, select');
                                    inputs.forEach(input => {
                                        if (input.type === 'file') {
                                            input.value = '';
                                        } else if (input.tagName === 'SELECT') {
                                            input.selectedIndex = 0;
                                        } else {
                                            input.value = '';
                                        }
                                    });
                                    
                                    // Clear all checkboxes
                                    const checkboxes = itemContainer.querySelectorAll('input[type="checkbox"]');
                                    checkboxes.forEach(cb => {
                                        cb.checked = false;
                                    });
                                    
                                    // Hide file upload confirmation
                                    const fileNameDisplay = document.getElementById(`fileName${j}`);
                                    if (fileNameDisplay) {
                                        fileNameDisplay.textContent = '';
                                        fileNameDisplay.classList.remove('active');
                                    }
                                    
                                    // Hide all product specs
                                    const metalSpecs = document.getElementById(`item${j}_metal_specs`);
                                    const magnetSpecs = document.getElementById(`item${j}_magnet_specs`);
                                    const labelSpecs = document.getElementById(`item${j}_label_specs`);
                                    if (metalSpecs) metalSpecs.classList.remove('active');
                                    if (magnetSpecs) magnetSpecs.classList.remove('active');
                                    if (labelSpecs) labelSpecs.classList.remove('active');
                                }
                            }
                            
                            // Uncheck and hide all subsequent items
                            for (let j = itemNum + 1; j <= 5; j++) {
                                const checkbox = document.getElementById(`addItem${j}`);
                                if (checkbox) checkbox.checked = false;
                                const container = document.getElementById(`item${j}_container`);
                                if (container) container.classList.remove('active');
                                const addSection = document.getElementById(`add_item${j}_section`);
                                if (addSection) addSection.style.display = 'none';
                            }
                        }
                    });
                }
            }
        }
        
        // Setup listeners for all 5 items
        for (let i = 1; i <= 5; i++) {
            setupItemListeners(i);
        }
        
        // Form submission
        document.getElementById('quoteForm').addEventListener('submit', function(e) {
            // First, disable all form fields in inactive item containers
            for (let i = 1; i <= 5; i++) {
                const container = document.getElementById(`item${i}_container`);
                if (!container || !container.classList.contains('active')) {
                    // Disable all inputs, selects, textareas, and file inputs in this container
                    const fields = container.querySelectorAll('input, select, textarea');
                    fields.forEach(field => {
                        field.disabled = true;
                    });
                } else {
                    // For active items, disable fields in inactive product spec sections
                    const productTypeSelect = document.getElementById(`item${i}_product_type`);
                    const selectedType = productTypeSelect ? productTypeSelect.value : '';
                    
                    const metalSpecs = document.getElementById(`item${i}_metal_specs`);
                    const magnetSpecs = document.getElementById(`item${i}_magnet_specs`);
                    const labelSpecs = document.getElementById(`item${i}_label_specs`);
                    const otherSpecs = document.getElementById(`item${i}_other_specs`);
                    
                    // Disable fields in non-selected product type sections
                    if (selectedType !== 'Metal Tags' && metalSpecs) {
                        const fields = metalSpecs.querySelectorAll('input, select, textarea');
                        fields.forEach(field => field.disabled = true);
                    }
                    if (selectedType !== 'Magnets' && magnetSpecs) {
                        const fields = magnetSpecs.querySelectorAll('input, select, textarea');
                        fields.forEach(field => field.disabled = true);
                    }
                    if (selectedType !== 'Custom Labels' && labelSpecs) {
                        const fields = labelSpecs.querySelectorAll('input, select, textarea');
                        fields.forEach(field => field.disabled = true);
                    }
                    if (selectedType !== 'Other' && otherSpecs) {
                        const fields = otherSpecs.querySelectorAll('input, select, textarea');
                        fields.forEach(field => field.disabled = true);
                    }
                }
            }
            
            const formData = new FormData(this);
            
            // Map sales reps to their email addresses
            const repEmails = {
                'Roman': 'roman@certags.com',
                'Zack': 'zack@certags.com',
                'Andrew': 'andrew@certags.com',
                'Jake': 'jake@certags.com',
                'Jose': 'jose@certags.com',
                'Tanner': 'tanner@certags.com'
            };
            
            const salesRep = formData.get('sales_rep');
            const customerCompany = formData.get('customer_company');
            
            // Set reply-to email and CC the sales rep
            if (repEmails[salesRep]) {
                document.getElementById('reply_to_email').value = repEmails[salesRep];
                document.getElementById('cc_email').value = repEmails[salesRep];
                document.getElementById('sales_rep_email_visible').value = repEmails[salesRep];
            }
            
            // Set dynamic subject line with product type(s)
            
            // Collect all product types
            let productTypes = [];
            for (let i = 1; i <= 5; i++) {
                const container = document.getElementById(`item${i}_container`);
                if (container && container.classList.contains('active')) {
                    const productType = formData.get(`item${i}_product_type`);
                    if (productType && productType !== 'Other') {
                        if (!productTypes.includes(productType)) {
                            productTypes.push(productType);
                        }
                    } else if (productType === 'Other') {
                        const otherType = formData.get(`item${i}_product_type_other`);
                        if (otherType && !productTypes.includes(otherType)) {
                            productTypes.push(otherType);
                        }
                    }
                }
            }
            
            // Format product types for subject
            let productTypeText = 'Multiple Products';
            if (productTypes.length === 1) {
                productTypeText = productTypes[0];
            } else if (productTypes.length === 2) {
                productTypeText = productTypes.join(' & ');
            } else if (productTypes.length > 2) {
                productTypeText = 'Multiple Products';
            }
            
            document.getElementById('email_subject').value = `${salesRep} Quote for ${customerCompany} - ${productTypeText}`;
            
            const getCheckboxValues = (name) => {
                const checkboxes = document.querySelectorAll(`input[name="${name}"]:checked`);
                const values = [];
                checkboxes.forEach(cb => {
                    if (cb.value === 'Other') {
                        const otherText = formData.get(name + '_other');
                        if (otherText && otherText.trim()) {
                            values.push('Other: ' + otherText.trim());
                        } else {
                            values.push('Other');
                        }
                    } else {
                        values.push(cb.value);
                    }
                });
                return values.length > 0 ? values.join(', ') : '';
            };
            
            const getDropdownValue = (field) => {
                const value = formData.get(field);
                if (value === 'Other') {
                    const otherText = formData.get(field + '_other');
                    return otherText && otherText.trim() ? 'Other: ' + otherText.trim() : 'Other';
                }
                return value || '';
            };
            
            const getHoleValue = (itemNum) => {
                const holeValue = formData.get(`item${itemNum}_hole`);
                if (!holeValue) return '';
                
                if (holeValue === 'Yes') {
                    const size = formData.get(`item${itemNum}_hole_size`);
                    return size && size.trim() ? `Yes (${size.trim()})` : 'Yes';
                } else if (holeValue === 'Multiple') {
                    const sizeNumber = formData.get(`item${itemNum}_hole_size_number`);
                    return sizeNumber && sizeNumber.trim() ? `Multiple (${sizeNumber.trim()})` : 'Multiple';
                } else if (holeValue === 'Other') {
                    const otherText = formData.get(`item${itemNum}_hole_other`);
                    return otherText && otherText.trim() ? `Other: ${otherText.trim()}` : 'Other';
                }
                return holeValue;
            };
            
            let formatted = '=== QUOTE REQUEST ===\n\n';
            formatted += 'Sales Rep: ' + formData.get('sales_rep') + '\n';
            formatted += 'Customer: ' + formData.get('customer_company') + '\n\n';
            
            // Loop through all items and only include active ones
            for (let i = 1; i <= 5; i++) {
                const container = document.getElementById(`item${i}_container`);
                // Skip if container is not active (not checked/visible)
                if (!container || !container.classList.contains('active')) continue;
                
                const itemType = formData.get(`item${i}_product_type`);
                if (!itemType) continue; // Skip if product type not selected
                
                formatted += `--- ITEM ${i} ---\n`;
                formatted += 'Product Type: ' + (itemType === 'Other' ? formData.get(`item${i}_product_type_other`) : itemType) + '\n';
                formatted += 'Quantity: ' + (formData.get(`item${i}_quantity`) || '') + '\n';
                formatted += 'Size: ' + (formData.get(`item${i}_size`) || '') + '\n';
                
                if (itemType === 'Metal Tags') {
                    formatted += 'Material: ' + getCheckboxValues(`item${i}_material`) + '\n';
                    formatted += 'Thickness: ' + getCheckboxValues(`item${i}_thickness`) + '\n';
                    formatted += 'Print: ' + getDropdownValue(`item${i}_print`) + '\n';
                    formatted += 'Print Method: ' + getCheckboxValues(`item${i}_print_method`) + '\n';
                    formatted += 'Print Color: ' + getDropdownValue(`item${i}_print_color`) + '\n';
                    formatted += 'Hole: ' + getHoleValue(i) + '\n';
                    formatted += 'Adhesive: ' + getDropdownValue(`item${i}_adhesive`) + '\n';
                    formatted += 'Variable Data: ' + getDropdownValue(`item${i}_variable_data_metal`) + '\n';
                } else if (itemType === 'Magnets') {
                    formatted += 'Laminated: ' + (formData.get(`item${i}_laminated_magnet`) || 'Yes') + '\n';
                    formatted += 'Print: ' + getDropdownValue(`item${i}_print_magnet`) + '\n';
                    formatted += 'Variable Data: ' + (formData.get(`item${i}_variable_data_magnet`) || '') + '\n';
                } else if (itemType === 'Custom Labels') {
                    formatted += 'Material: ' + getDropdownValue(`item${i}_material_label`) + '\n';
                    formatted += 'Laminated: ' + (formData.get(`item${i}_laminated_label`) || 'Yes') + '\n';
                    formatted += 'Print: ' + getDropdownValue(`item${i}_print_label`) + '\n';
                    formatted += 'Variable Data: ' + (formData.get(`item${i}_variable_data_label`) || '') + '\n';
                }
                
                const itemOther = formData.get(`item${i}_other_info`);
                if (itemOther && itemOther.trim()) {
                    formatted += 'Other Comments: ' + itemOther + '\n';
                }
                
                // Previously Quoted info
                const prevQuoted = formData.get(`item${i}_previously_quoted`);
                if (prevQuoted) {
                    formatted += 'Previously Quoted/Ordered: ' + prevQuoted;
                    if (prevQuoted === 'Yes') {
                        const details = formData.get(`item${i}_previously_quoted_details`);
                        if (details && details.trim()) {
                            formatted += ' (' + details.trim() + ')';
                        }
                    }
                    formatted += '\n';
                }
                
                formatted += '\n'; // Add spacing between items
            }
            
            document.getElementById('formatted_quote').value = formatted;
        });
    </script>
    
</body>
</html>
